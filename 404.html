<!DOCTYPE html>
<html>
<head>
    <script>
        // Get the current full URL
        const currentUrl = window.location.href;
        
        // Function to extract the base URL without recursive parameters
        function extractBaseUrl(url) {
            try {
                const parsedUrl = new URL(url);
                return parsedUrl.origin + parsedUrl.pathname;
            } catch {
                return url;
            }
        }
        
        // Check if the URL is already a 404 page to prevent infinite recursion
        if (currentUrl.includes('/404.html') || currentUrl.includes('/404')) {
            // If it's already a 404 page, extract the original URL from the query parameter
            const urlParams = new URLSearchParams(window.location.search);
            const originalUrl = urlParams.get('url');
            
            if (originalUrl) {
                // Extract the base URL to prevent recursive encoding
                const baseOriginalUrl = extractBaseUrl(decodeURIComponent(originalUrl));
                
                // Redirect to the 404 page with the base original URL
                window.location.href = `/404?url=${encodeURIComponent(baseOriginalUrl)}`;
            } else {
                // Fallback to home page if no original URL is found
                window.location.href = '/';
            }
        } else {
            // Normal 404 redirection
            window.location.href = `/404?url=${encodeURIComponent(currentUrl)}`;
        }
    </script>
</head>
<body>
    Redirecting...
</body>
</html>